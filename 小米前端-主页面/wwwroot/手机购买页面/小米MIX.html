<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>小米MIX</title>
		<link rel="stylesheet" type="text/css" href="../bootstrap/css/bootstrap.css"/>
		<link rel="stylesheet" type="text/css" href="手机购买页面.css"/>
		<style type="text/css">
			
		</style>
	</head>
	<body>
		<header>
			<div>
				<a href="../index.html"><img style="position: absolute;top: 22px;" src="../小米图片/footer/logo-footer.png" alt="" /></a>
			</div>
		</header>
		
		<div class="xmPhone-1">
			<div>
				<a class="navBorder" href="小米MIX.html">小米MIX</a>
				<a href="小米note 2.html">小米note 2</a>
				<a href="小米5s.html">小米手机5s</a>
				<a href="小米5s plus.html">小米手机5s Plus</a>
				<a href="红米Note 4X.html">红米Note 4X</a>
				<a href="红米Note 4.html">红米Note 4</a>
				<a href="红米手机4.html">红米手机4</a>
				<a href="小米手机5.html">小米手机5</a>
				<a href="小米Max.html">小米Max</a>
			</div>
			
		</div>
		
		<div class="xmPhone-2">
				<div>
					<span><img id="img" style="margin-top: 100px;" src="手机图片/小米MIX.jpg"/></span>
					<span style="float: right;margin-top: 100px;">
						<div style="position: relative;border-bottom: 1px solid gray;">
							<b style="font-size: 40px;">购买小米MIX <i id="price" style="color: orangered;">3499元</i></b>
							<a href="" style="position: absolute;top:30px;right: 0;color: gray;">深入了解产品 > </a>
						</div>
						
						<div style="height: 140px;">
							<p style="color: darkgray;"><i style="font-size: 30px;color: black;font-style: normal;">1.选择版本</i> &#x3000;&#x3000;骁龙821最高主频，2.35GHz，Adreno 530 图形处理器</p>
							<a name="MIX" class="border" href="javascript:void(0)" data-info='小米MIX 标准版 4GB内存+128GB容量' data-price='3499元'>标准版 4GB内存+128GB容量</a>
							<a name="MIX" href="javascript:void(0)" data-info='小米MIX 尊享版 6GB内存+256GB容量' data-price='3999元'>尊享版 6GB内存+256GB容量 </a>
						</div>
						
						<div style="height: 140px;">
							<p><i style="font-size: 30px;color: black;font-style: normal;">2.选择颜色</i></p>
							<a name="mixColor" class="border"  href="javascript:void(0)" data-color='黑色'>黑色 </a>
							<a name="mixColor" href="javascript:void(0)" data-color='皓月白 '>皓月白 </a>
						</div>
						
						<div style="margin-top: 20px;">
							<p style="font-size: 20px;">您选择了以下产品:</p>
						</div>
						
						<form id="for" style="position: relative;top: -60px;" action="/buy" method="post">
							<textarea name="content" id="p1" style="color: gray;width:400px;height: 30px;resize: none;border: none;"></textarea>
							<br />
							<input type="submit" value="立即购买"  style="width: 200px;line-height: 40px;background-color: orangered;color:white;font-size: 20px;text-align: center;border: none;"></input>
							<input id="join" type="submit" value="加入购物车" style="width: 200px;line-height: 40px;background-color: orangered;color:white;font-size: 20px;text-align: center;margin-left:50px;border: none;"></input>
						</form>
					</span>
				</div>
			</div>
			
			<!--模态框-->	
		<div class="modal fade" role="dialog" id="myModal">
			 <div class="modal-dialog modal-sm">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
						<h4 class="modal-title" id="myModalLabel">小米购物车</h4>
					</div>
					<div class="modal-body">
						
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">确定</button>
					</div>
				</div>
			</div>
		</div>	
			
	</body>
</html>
<script src="../bootstrap/js/jquery-3.1.1.js" type="text/javascript"></script>
<script src="../bootstrap/js/bootstrap.js" type="text/javascript"></script>


<script type="text/javascript">
	var mixs = document.getElementsByName('MIX');
	var mixColor = document.getElementsByName('mixColor');
	var p = document.getElementById('p');
	var price = document.getElementById('price');
	var img = document.getElementById('img');
	
	var phones = document.querySelectorAll('.xmPhone-1 a');
	
	
	var lastIndex = 0;
	
	for(var i=0;i<mixs.length;i++){
		mixs[i].addEventListener('click',function(){
			//清除上一个的class
			mixs[lastIndex].className = '';
			//给当前的点击对象添加class
			this.className = 'border';
			//将mixs转换成数组从而使用indexof（）方法
			lastIndex = Array.from(mixs).indexOf(this);
			if(lastIndex == 1){
				mixColor[1].style.display = 'none';
			}
			else{
				mixColor[1].style.display = 'inline-block';
			}
			p1.innerHTML = mixs[lastIndex].dataset.info;
			price.innerHTML = mixs[lastIndex].dataset.price;
		});
	}

	var index = 0;
	for(var i=0;i<mixColor.length;i++){
		mixColor[i].addEventListener('click',function(){
			mixColor[index].className = '';
			this.className = 'border';
			index = Array.from(mixColor).indexOf(this);
			if(index == 1){
				img.src = '手机图片/小米MIX皓月白.png'
			}
			else{
				img.src = '手机图片/小米MIX.jpg'
			}
			p1.innerHTML = mixs[lastIndex].dataset.info + ' ' + mixColor[index].dataset.color + ' ' + mixs[lastIndex].dataset.price;
		});
	}
	
	var topIndex=0
	for(var i=0;i<phones.length;i++){
		phones[i].addEventListener('click',function(){
			phones[topIndex].className = '';
			this.className = 'navBorder';
			topIndex = Array.from(phones).indexOf(this);
		})
	}
	
//加入购物车
$('#join').click(function(){
	$('#for').submit(function(event){
		event.preventDefault();
		
		var data = $(this).serialize();
		$.post('/buy',data,function(resData){
			$('.modal-body').text(resData.message);
			$('#myModal').modal('show').on('hide.bs.modal',function(){
				if(resData.code == 1){
					location.href = '../index.html';
				}else if(resData.code == 3){
					location.reload();
				}
			});
		})
		
	})
})

</script>